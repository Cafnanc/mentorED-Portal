<div class="form-wrapper" *ngIf="showForm">
    <form [formGroup]="myForm" (ngSubmit)="onSubmit()">
        <div *ngFor="let control of jsonFormData?.controls" class="form-group">

            <!-- field labels -->
            <label 
                class="form-field-label" 
                [ngClass]="{
                    'form-field-invalid':myForm.get(control?.name)?.touched && myForm.get(control?.name)?.invalid
                }">
                {{control?.label}}
                <mat-icon *ngIf="control?.validators?.required"
                    class="error-icon-star">star
                </mat-icon>
            </label>

            <!-- field -->
            <mat-form-field *ngIf="textBoxTypes.includes(control?.type)" appearance="outline">
                <input matInput 
                    [placeholder]="control?.placeHolder"
                    [type]="control?.type"
                    [formControlName]="control?.name" 
                    [maxlength]="control?.validators.maxLength" 
                    [required]="control?.validators?.required">
                <mat-icon matSuffix 
                    *ngIf="control?.type === 'password' || control?.showPasswordIcon"
                    (click)="hideShowPassword(control)">
                    {{control?.type === 'password' ? 'visibility_off' : 'visibility'}}
                </mat-icon>
                <mat-icon matSuffix 
                    *ngIf="control?.type === 'secretCode'" 
                    (click)="alertToast()">info
                </mat-icon>
            </mat-form-field>

            <mat-form-field *ngIf="control?.type==='textarea'" appearance="outline">
                <textarea matInput 
                    [formControlName]="control?.name"
                    [placeholder]="control?.placeHolder"
                    [maxlength]="control?.validators?.maxLength"
                    [required]="control?.validators?.required">
                </textarea>
            </mat-form-field>

            <mat-form-field *ngIf="control?.type==='select'" appearance="outline">
                <mat-select 
                    [value]="control?.value"
                    [formControlName]="control?.name"
                    [compareWith]="compareWith"
                    [required]="control?.validators?.required">
                    <mat-option
                        *ngFor="let option of control?.options"
                        [value]="option.value">
                        {{option.label}}
                    </mat-option>
                </mat-select>
            </mat-form-field>

            <mat-form-field *ngIf="control?.type === 'toggle'" appearance="outline">
                <mat-slide-toggle
                    [formControlName]="control?.name" 
                    [checked]="control?.value"
                    [required]="control?.validators?.required">
                </mat-slide-toggle>
                <textarea matInput
                    [required]="control?.validators?.required"
                    hidden>
                </textarea>
            </mat-form-field>

            <mat-form-field *ngIf="control?.type==='range'" appearance="outline">
                <mat-slider
                    thumbLabel
                    [step]="control?.step"
                    [max]="control?.max"
                    [min]="control?.min"
                    [value]="control?.value"
                    [formControlName]="control?.name">
                </mat-slider>
                <textarea matInput
                    [required]="control?.validators?.required"
                    hidden>
                </textarea>
            </mat-form-field>

            <mat-form-field *ngIf="control?.type==='chip'" appearance="outline">
                <app-input-chip
                    [formControlName]="control?.name"
                    [chipControl]="control">
                </app-input-chip>
                <textarea matInput
                    hidden>
                </textarea>
            </mat-form-field>

            <mat-form-field *ngIf="control?.type === 'rating'" appearance="outline">
                <app-star-rating
                    [formControlName]="control.name"
                    [label]="control.label"
                    [numberOfStars]="control.noOfstars"
                ></app-star-rating>
                <textarea matInput
                    hidden>
                </textarea>
            </mat-form-field>

            <mat-form-field *ngIf="control?.type==='date'" appearance="outline">
                <input matInput autocomplete="off"
                    #date
                    [owlDateTimeTrigger]="dt"
                    [owlDateTime]="dt"
                    [placeholder]="control?.placeHolder"
                    [formControlName]="control?.name"
                    [value]="control?.value"
                    [max]="(dependedParentDate && control.name === dependedParent)?dependedParentDate:maxDate"
                    [min]="(control.name === dependedChild)?dependedChildDate:currentDate"
                    [readonly]="control?.readonly"
                    [required]="control?.validators?.required">
                <owl-date-time #dt
                    [hour12Timer]="true"
                    (afterPickerClosed)="dateSelected(control, date)"></owl-date-time>
            </mat-form-field>

            <!-- validation errors -->
            <mat-error *ngIf="myForm.get(control?.name)?.touched && myForm.get(control?.name)?.invalid">
                <mat-icon 
                    class="error-icon-info" 
                    matPrefix>
                    error_outline
                </mat-icon>
                {{control?.errorMessage}}
            </mat-error>
        </div>
    </form>
</div>